apiVersion: authentication.kubedoop.dev/v1alpha1
kind: AuthenticationClass
metadata:
  name: oidc-keycloak
spec:
  provider:
    oidc:
      hostname: keycloak
      port: 8080
      rootPath: (join('', ['/realms/', ($KEYCLOAK_REALM)]))
      providerHint: keycloak
      scopes:
        - openid
        - email
        - profile
      principalClaim: preferred_username
---
apiVersion: v1
kind: Secret
metadata:
  name: oidc-secret
type: kubernetes.io/opaque
stringData:
  CLIENT_ID: ($KEYCLOAK_CLIENT_ID)
  CLIENT_SECRET: ($KEYCLOAK_CLIENT_SECRET)
